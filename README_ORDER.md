# ğŸ½ï¸ UniBar ì£¼ë¬¸ ì‹œìŠ¤í…œ ê°€ì´ë“œ

UniBar í”„ë¡œì íŠ¸ì˜ **ì£¼ë¬¸ ê´€ë¦¬ ì‹œìŠ¤í…œ(Order Management System)**ì— ëŒ€í•œ ë¬¸ì„œì…ë‹ˆë‹¤.
ì´ ì‹œìŠ¤í…œì€ í…Œì´ë¸”ë³„ ì£¼ë¬¸ ìƒì„±, ì¡°íšŒ, ê²°ì œ ì²˜ë¦¬ë¥¼ ë‹´ë‹¹í•˜ë©°, **ì‚¬ìš©ì(ì ì£¼)ë³„ë¡œ ë°ì´í„°ê°€ ì² ì €íˆ ê²©ë¦¬**ë˜ì–´ ê´€ë¦¬ë©ë‹ˆë‹¤.

---

## 1. ì£¼ìš” ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… | ì—”ë“œí¬ì¸íŠ¸ | ê¶Œí•œ |
|---|---|---|---|
| **ì£¼ë¬¸ ìƒì„±** | íŠ¹ì • í…Œì´ë¸”ì— ìƒˆë¡œìš´ ì£¼ë¬¸ì„ ì¶”ê°€í•©ë‹ˆë‹¤. | `POST /api/orders` | ì¸ì¦ëœ ì‚¬ìš©ì |
| **í…Œì´ë¸” ì£¼ë¬¸ ì¡°íšŒ** | íŠ¹ì • í…Œì´ë¸”ì˜ ë¯¸ê²°ì œ ì£¼ë¬¸ ë‚´ì—­ì„ ì¡°íšŒí•©ë‹ˆë‹¤. | `GET /api/orders/table/{tableId}` | ì¸ì¦ëœ ì‚¬ìš©ì |
| **ì „ì²´ ì£¼ë¬¸ ì¡°íšŒ** | í•´ë‹¹ ì ì£¼ì˜ ëª¨ë“  ì£¼ë¬¸ ë‚´ì—­(ë§¤ì¶œ)ì„ ì¡°íšŒí•©ë‹ˆë‹¤. | `GET /api/orders` | ì¸ì¦ëœ ì‚¬ìš©ì |
| **ì£¼ë¬¸ ê²°ì œ** | íŠ¹ì • ì£¼ë¬¸ì„ ê²°ì œ ì™„ë£Œ ì²˜ë¦¬í•©ë‹ˆë‹¤. | `POST /api/orders/{id}/pay` | ì¸ì¦ëœ ì‚¬ìš©ì |

> **Note**: ëª¨ë“  ë°ì´í„° ì¡°íšŒ ë° ìˆ˜ì • ì‹œ, í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ID(`ownerId`)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•„í„°ë§ë˜ë¯€ë¡œ ë‹¤ë¥¸ ì ì£¼ì˜ ë°ì´í„°ì—ëŠ” ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

---

## 2. API ëª…ì„¸ (API Specification)

ëª¨ë“  API ìš”ì²­ í—¤ë”ì—ëŠ” `Authorization: Bearer {token}`ì´ í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

### 2.1 ì£¼ë¬¸ ìƒì„± (Create Order)
*   **URL**: `/api/orders`
*   **Method**: `POST`
*   **Request Body**:
    ```json
    {
      "tableId": 1,
      "tableName": "1ë²ˆ í…Œì´ë¸”",
      "items": [
        {
          "id": 101,
          "name": "ê¹€ì¹˜ì°Œê°œ",
          "quantity": 2,
          "price": 8000
        },
        {
          "id": 102,
          "name": "ê³µê¸°ë°¥",
          "quantity": 2,
          "price": 1000
        }
      ],
      "totalPrice": 18000
    }
    ```
*   **Response**: ìƒì„±ëœ ì£¼ë¬¸ ê°ì²´ (JSON)

### 2.2 í…Œì´ë¸” ì£¼ë¬¸ ì¡°íšŒ (Get Table Orders)
*   **URL**: `/api/orders/table/{tableId}`
*   **Method**: `GET`
*   **Response**:
    ```json
    [
      {
        "id": "65a...",
        "ownerId": "user123",
        "tableId": 1,
        "tableName": "1ë²ˆ í…Œì´ë¸”",
        "items": [...],
        "isPaid": false,
        "orderTime": "12:30",
        "createdAt": "2023-11-25T12:30:00"
      }
    ]
    ```

### 2.3 ì£¼ë¬¸ ê²°ì œ (Pay Order)
*   **URL**: `/api/orders/{orderId}/pay`
*   **Method**: `POST`
*   **Response**: ê²°ì œ ì™„ë£Œëœ ì£¼ë¬¸ ê°ì²´ (`isPaid: true`)

---

## 3. ë°ì´í„° ëª¨ë¸ (Data Model)

### Order (ì£¼ë¬¸)
MongoDB `orders` ì»¬ë ‰ì…˜ì— ì €ì¥ë©ë‹ˆë‹¤.

| í•„ë“œëª… | íƒ€ì… | ì„¤ëª… |
|---|---|---|
| `id` | String | MongoDB Document ID |
| `ownerId` | String | **ë°ì´í„° ì†Œìœ ì ID (User.id)** |
| `orderId` | Long | í”„ë¡ íŠ¸ì—”ë“œìš© íƒ€ì„ìŠ¤íƒ¬í”„ ID |
| `tableId` | Integer | í…Œì´ë¸” ë²ˆí˜¸ |
| `tableName` | String | í…Œì´ë¸” ì´ë¦„ |
| `items` | List<OrderItem> | ì£¼ë¬¸ ë©”ë‰´ ëª©ë¡ |
| `totalPrice` | Integer | ì´ ì£¼ë¬¸ ê¸ˆì•¡ |
| `isPaid` | Boolean | ê²°ì œ ì—¬ë¶€ |
| `isCompleted` | Boolean | ì¡°ë¦¬ ì™„ë£Œ ì—¬ë¶€ |
| `createdAt` | DateTime | ìƒì„± ì‹œê°„ |

### OrderItem (ì£¼ë¬¸ í•­ëª©)
Order ë‚´ë¶€ì— í¬í•¨ë˜ëŠ” í•˜ìœ„ ë¬¸ì„œì…ë‹ˆë‹¤.

| í•„ë“œëª… | íƒ€ì… | ì„¤ëª… |
|---|---|---|
| `id` | Long | ë©”ë‰´ ID |
| `name` | String | ë©”ë‰´ ì´ë¦„ |
| `quantity` | Integer | ì£¼ë¬¸ ìˆ˜ëŸ‰ |
| `price` | Integer | ê°œë‹¹ ê°€ê²© |

---

## 4. ë°ì´í„° ê²©ë¦¬ ì •ì±… (Data Isolation)

UniBarëŠ” ë©€í‹° í…Œë„ŒíŠ¸(Multi-tenant)ì™€ ìœ ì‚¬í•œ êµ¬ì¡°ë¥¼ ê°€ì§‘ë‹ˆë‹¤.
*   ëª¨ë“  `Order` ë°ì´í„°ëŠ” `ownerId` í•„ë“œë¥¼ ê°€ì§‘ë‹ˆë‹¤.
*   `OrderService`ì—ì„œ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ê±°ë‚˜ ìˆ˜ì •í•  ë•Œ, í•­ìƒ **í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ID**ì™€ `ownerId`ê°€ ì¼ì¹˜í•˜ëŠ”ì§€ ê²€ì¦í•©ë‹ˆë‹¤.
*   ë”°ë¼ì„œ A ì ì£¼ê°€ B ì ì£¼ì˜ ì£¼ë¬¸ ë‚´ì—­ì„ ë³´ê±°ë‚˜ ìˆ˜ì •í•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.

